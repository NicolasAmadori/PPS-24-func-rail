import TestCell.cells
import controller.simconfig.SimulationConfigController
import model.mapgrid.{BigStationBorderPiece, BigStationCenterPiece, Cell, EmptyCell, MapGrid, MetalRailPiece, SmallStationPiece, TitaniumRailPiece}
import model.util.RailwayMapper
import scalafx.application.JFXApp3
import scalafx.scene.Scene
import utils.StageManager
import view.simconfig.SimulationConfigView

object SimConfigMain extends JFXApp3:

  val rows: Int = 50
  val cols: Int = 70

  override def start(): Unit =
    val grid = MapGrid(20, 20, cells, 10)

    val controller = SimulationConfigController(grid, RailwayMapper.convert(grid))
    val view = SimulationConfigView(controller)

    controller.attachView(view)

    val stageInstance = new JFXApp3.PrimaryStage:
      title = "Simulation Configurator"
      minWidth = 1000
      minHeight = 800
      scene = new Scene(view.getRoot)
      onShown = _ => view.initGraph()

    StageManager.init(stageInstance)

    stage = stageInstance

object TestCell:
  val e: Cell = EmptyCell
  val emptyRow: Vector[Cell] = Vector.fill(20)(e)
  val cells: Vector[Vector[Cell]] = Vector(
    emptyRow,
    emptyRow,
    Vector(
      e,
      e,
      SmallStationPiece(2),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      SmallStationPiece(3),
      MetalRailPiece(),
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      MetalRailPiece(),
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      MetalRailPiece(),
      SmallStationPiece(4),
      MetalRailPiece(),
      MetalRailPiece(),
      MetalRailPiece(),
      MetalRailPiece(),
      MetalRailPiece(),
      MetalRailPiece(),
      SmallStationPiece(5),
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      MetalRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      SmallStationPiece(6),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      TitaniumRailPiece(),
      SmallStationPiece(7),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      SmallStationPiece(8),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      TitaniumRailPiece(),
      e,
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      BigStationBorderPiece(1),
      BigStationBorderPiece(1),
      BigStationBorderPiece(1),
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      BigStationBorderPiece(1),
      BigStationCenterPiece(1),
      BigStationBorderPiece(1),
      e,
      e,
      e,
      e,
      e,
      e
    ),
    Vector(
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      e,
      BigStationBorderPiece(1),
      BigStationBorderPiece(1),
      BigStationBorderPiece(1),
      e,
      e,
      e,
      e,
      e,
      e
    ),
    emptyRow
  )
